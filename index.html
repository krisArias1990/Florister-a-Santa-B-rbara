<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Floristería Santa Bárbara: arreglos florales para todas las ocasiones en Heredia, Costa Rica.">
  <title>Floristería Santa Bárbara</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* ESTILOS TEMPORALES (PUEDES MOVER A style.css) */
    .banner-superior img { width: 100%; height: auto; display: block; }
    .banner-floristeria { text-align: center; margin: 1rem 0; }
    .banner-floristeria img { width: 100%; max-width: 600px; height: auto; }
    .header-content { display: none; } /* Oculta logo pequeño */
    nav { background: #fff; padding: 0.5rem 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    nav ul { list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; }
    nav ul li a { color: #d1477a; text-decoration: none; font-weight: 600; font-size: 0.95rem; }
    nav ul li a:hover { text-decoration: underline; }
  </style>
</head>
<body>

  <!-- 1. BANNER SUPERIOR -->
  <div class="banner-superior">
    <img src="https://raw.githubusercontent.com/krisArias1990/Florister-a-Santa-B-rbara/main/assets/banner-superior.jpg" alt="Flores, expresión del sentimiento">
  </div>

  <!-- 2. CARRUSEL -->
  <section class="carousel">
    <div class="carousel-inner" id="carousel-inner"></div>
    <div class="carousel-indicators" id="carousel-indicators"></div>
    <div class="carousel-controls">
      <button class="carousel-prev" onclick="showSlide(currentIndex - 1)">❮</button>
      <button class="carousel-next" onclick="showSlide(currentIndex + 1)">❯</button>
    </div>
  </section>

  <!-- 3. BANNER FLORISTERÍA (LOGO GRANDE) -->
  <div class="banner-floristeria">
    <img src="https://raw.githubusercontent.com/krisArias1990/Florister-a-Santa-B-rbara/main/assets/banner-floristeria.jpg" alt="Floristería Santa Bárbara">
  </div>

  <!-- 4. MENÚ DE CATEGORÍAS -->
  <nav><ul id="menuCategorias"></ul></nav>

  <!-- CATÁLOGO -->
  <main id="catalogo"><p style="text-align:center;padding:2rem;color:#888;">Cargando...</p></main>

  <!-- LIGHTBOX -->
  <div id="lightbox" class="lightbox" onclick="cerrarLightbox()">
    <img id="lightbox-img" src="" alt="">
    <div class="lightbox-text">
      <h3 id="lightbox-nombre"></h3>
      <p id="lightbox-categoria"></p>
    </div>
  </div>

  <!-- BOTONES FLOTANTES -->
  <a href="https://wa.me/50686053613" class="whatsapp-flotante" target="_blank">WhatsApp</a>
  <button class="btn-inicio" onclick="window.scrollTo({top:0,behavior:'smooth'})">↑ Inicio</button>

  <!-- FOOTER -->
  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>Contáctenos</h3>
        <p>WhatsApp: <a href="https://wa.me/50686053613" target="_blank" style="color:#d1477a; text-decoration:underline;">8605-3613</a></p>
        <p>WhatsApp: <a href="https://wa.me/50622699803" target="_blank" style="color:#d1477a; text-decoration:underline;">2269-9803</a></p>
        <p>Santa Bárbara, Heredia, Costa Rica</p>
        <p style="font-size:0.85rem;">
          <a href="https://waze.com/ul?q=Santa+B%C3%A1rbara,+Heredia" target="_blank" style="color:#d1477a; margin-right:0.8rem;">Waze</a> |
          <a href="https://maps.app.goo.gl/Ns5gsNEV9rd7Ubfv8?g_st=aw" target="_blank" style="color:#d1477a;">Google Maps</a>
        </p>
        <p>Horario: Lunes a Sábado 8am-6pm</p>
      </div>
      <div class="footer-section">
        <h3>Redes Sociales</h3>
        <p><a href="https://www.facebook.com/share/19t8Z9fFwM/" target="_blank" style="color:#d1477a;">Facebook</a></p>
        <p><a href="https://www.instagram.com/floristsantabarbara?utm_source=qr&igsh=MW42czJpcHA3eXZvZg==" target="_blank" style="color:#d1477a;">Instagram</a></p>
        <p><a href="https://www.tiktok.com/@florist.santabarbara?_r=1&_t=ZM-914rEFKhTAZ" target="_blank" style="color:#d1477a;">TikTok</a></p>
      </div>
      <div class="footer-section">
        <h3>Formas de Pago</h3>
        <p>SINPE Móvil</p>
        <p>Datáfono (tarjetas)</p>
        <p>Link de pago</p>
        <p>Transferencia</p>
      </div>
    </div>
    <div class="footer-bottom"><p>© Floristería Santa Bárbara 2025</p></div>
  </footer>

  <script>
    const temporadasAltas = [
      { inicio: "2025-02-01", fin: "2025-02-15" },
      { inicio: "2025-05-01", fin: "2025-05-15" },
      { inicio: "2025-11-15", fin: "2025-12-31" }
    ];

    function enTemporadaAlta(hoy) {
      return temporadasAltas.some(t => hoy >= new Date(t.inicio) && hoy <= new Date(t.fin));
    }

    async function cargarProductos() {
      try {
        const res = await fetch('productos.json?_=' + Date.now());
        if (res.ok) return await res.json();
      } catch (e) {
        console.warn('Error:', e);
      }
      return [];
    }

    function generarPedido(producto, precio) {
      const categoriaId = encodeURIComponent(producto.categoria);
      const productoId = producto.id || producto.nombre.replace(/\s+/g, '_');
      const enlaceProducto = `https://krisarias1990.github.io/Florister-a-Santa-B-rbara/#${categoriaId}_${productoId}`;
      const fotoUrl = producto.foto_full || producto.foto;

      const mensaje = `¡Hola! Quisiera pedir:

*Producto:* ${producto.nombre}
*Precio:* ₡${precio.toLocaleString()}
*Categoría:* ${producto.categoria}

${fotoUrl}

[Ver producto →](${enlaceProducto})

Gracias!`;

      const url = `https://wa.me/50686053613?text=${encodeURIComponent(mensaje)}`;
      window.open(url, '_blank');
    }

    function abrirLightbox(p) {
      document.getElementById('lightbox-img').src = p.foto_full || p.foto;
      document.getElementById('lightbox-nombre').textContent = p.nombre;
      document.getElementById('lightbox-categoria').textContent = p.categoria;
      document.getElementById('lightbox').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function cerrarLightbox() {
      document.getElementById('lightbox').classList.remove('active');
      document.body.style.overflow = '';
    }

    let currentIndex = 0;
    const banners = [
      { img: "https://raw.githubusercontent.com/krisArias1990/Florister-a-Santa-B-rbara/main/flores/amor-y-amistad/full/IMG_5816.jpeg", category: "Amor y Amistad" },
      { img: "https://raw.githubusercontent.com/krisArias1990/Florister-a-Santa-B-rbara/main/flores/arreglos/full/IMG_5825.jpeg", category: "Día de la Madre" },
      { img: "https://raw.githubusercontent.com/krisArias1990/Florister-a-Santa-B-rbara/main/flores/bodas/full/BODAS.jpg", category: "Bodas" }
    ];

    function renderCarousel() {
      const inner = document.getElementById('carousel-inner');
      const indicators = document.getElementById('carousel-indicators');
      inner.innerHTML = banners.map((b, i) => `
        <a href="#${encodeURIComponent(b.category)}" class="carousel-link">
          <div class="carousel-item">
            <img src="${b.img}" alt="${b.category}" loading="lazy">
            <div class="carousel-caption">
              <h3>${b.category}</h3>
              <p>WhatsApp: 8605-3613</p>
            </div>
          </div>
        </a>
      `).join('');
      indicators.innerHTML = banners.map((_, i) => `<span data-index="${i}" ${i===0?'class="active"':''}></span>`).join('');
      indicators.querySelectorAll('span').forEach(dot => dot.addEventListener('click', () => goToSlide(+dot.dataset.index)));
      showSlide(0);
    }

    function showSlide(i) {
      const total = banners.length;
      if (i >= total) i = 0; if (i < 0) i = total - 1;
      currentIndex = i;
      document.getElementById('carousel-inner').style.transform = `translateX(-${i * 100}%)`;
      document.querySelectorAll('.carousel-indicators span').forEach((d, idx) => d.classList.toggle('active', idx === i));
    }

    function goToSlide(i) { showSlide(i); }

    async function renderCatalogo() {
      const productos = await cargarProductos();
      if (!productos.length) {
        document.getElementById('catalogo').innerHTML = '<p style="text-align:center;color:#888;padding:2rem;">No hay productos.</p>';
        return;
      }

      const esAlta = enTemporadaAlta(new Date());
      const categorias = [...new Set(productos.map(p => p.categoria))];
      document.getElementById('menuCategorias').innerHTML = categorias.map(c => `<li><a href="#${encodeURIComponent(c)}">${c}</a></li>`).join('');

      const grupos = {};
      productos.forEach(p => {
        if (!grupos[p.categoria]) grupos[p.categoria] = [];
        grupos[p.categoria].push(p);
      });

      const catalogo = document.getElementById('catalogo');
      catalogo.innerHTML = Object.entries(grupos).map(([cat, prods]) => `
        <section class="categoria" id="${encodeURIComponent(cat)}">
          <h2>${cat}</h2>
          <div class="productos">
            ${prods.map(p => {
              const precio = esAlta ? p.precioAlta : p.precioBaja;
              const foto = p.foto_full || p.foto;
              const productoId = p.id || p.nombre.replace(/\s+/g, '_');
              return `
                <div class="producto" id="${encodeURIComponent(cat)}_${productoId}">
                  <img src="${foto}" alt="${p.nombre}" class="producto-img" onclick='abrirLightbox(${JSON.stringify(p).replace(/"/g, '&quot;')})' loading="lazy">
                  <h3>${p.nombre}</h3>
                  <p class="descripcion">${p.descripcion || ''}</p>
                  <p class="precio">₡${precio.toLocaleString()}</p>
                  <button class="btn-pedir" onclick='generarPedido(${JSON.stringify(p).replace(/"/g, '&quot;')}, ${precio})'>
                    Enviar por WhatsApp
                  </button>
                </div>
              `;
            }).join('')}
          </div>
        </section>
      `).join('');
    }

    document.addEventListener('DOMContentLoaded', () => {
      renderCarousel();
      renderCatalogo();
      setInterval(() => showSlide(currentIndex + 1), 5000);
    });
  </script>
</body>
</html>
